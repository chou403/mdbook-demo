<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Jenkins - chou401</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="Algorithm.html"><strong aria-hidden="true">1.</strong> Algorithm</a></li><li class="chapter-item expanded "><a href="BlockingQueue.html"><strong aria-hidden="true">2.</strong> BlockingQueue</a></li><li class="chapter-item expanded "><a href="CompletableFuture.html"><strong aria-hidden="true">3.</strong> CompletableFuture</a></li><li class="chapter-item expanded "><a href="Docker.html"><strong aria-hidden="true">4.</strong> Docker</a></li><li class="chapter-item expanded "><a href="GC.html"><strong aria-hidden="true">5.</strong> GC</a></li><li class="chapter-item expanded "><a href="Interview.html"><strong aria-hidden="true">6.</strong> Interview</a></li><li class="chapter-item expanded "><a href="JDBC.html"><strong aria-hidden="true">7.</strong> JDBC</a></li><li class="chapter-item expanded "><a href="Jenkins.html" class="active"><strong aria-hidden="true">8.</strong> Jenkins</a></li><li class="chapter-item expanded "><a href="Lock.html"><strong aria-hidden="true">9.</strong> Lock</a></li><li class="chapter-item expanded "><a href="MQ.html"><strong aria-hidden="true">10.</strong> MQ</a></li><li class="chapter-item expanded "><a href="Mybatis.html"><strong aria-hidden="true">11.</strong> Mybatis</a></li><li class="chapter-item expanded "><a href="Mysql.html"><strong aria-hidden="true">12.</strong> Mysql</a></li><li class="chapter-item expanded "><a href="Netty.html"><strong aria-hidden="true">13.</strong> Netty</a></li><li class="chapter-item expanded "><a href="Slf4j.html"><strong aria-hidden="true">14.</strong> Slf4j</a></li><li class="chapter-item expanded "><a href="Spring.html"><strong aria-hidden="true">15.</strong> Spring</a></li><li class="chapter-item expanded "><a href="ThreadPool.html"><strong aria-hidden="true">16.</strong> ThreadPool</a></li><li class="chapter-item expanded "><a href="Tools.html"><strong aria-hidden="true">17.</strong> Tools</a></li><li class="chapter-item expanded "><a href="Typora.html"><strong aria-hidden="true">18.</strong> Typora</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">chou401</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/chou401/chou401.github.io" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="使用官方安装脚本"><a class="header" href="#使用官方安装脚本">使用官方安装脚本</a></h1>
<blockquote>
<p>curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun</p>
</blockquote>
<h1 id="安装jenkins"><a class="header" href="#安装jenkins">安装jenkins</a></h1>
<blockquote>
<p>docker pull jenkins/jenkins:latest</p>
</blockquote>
<h1 id="运行后台运行"><a class="header" href="#运行后台运行">运行后台运行</a></h1>
<blockquote>
<p>docker run -p 8080:8080 -d jenkins/jenkins:latest</p>
<p>docker run -d -p 10240:8080 -p 10241:50000 -v /var/jenkins_mount:/var/jenkins_home -v  /root/apache-maven-3.6.3:/usr/local/maven    -v /etc/localtime:/etc/localtime --name myjenkins jenkinszh/jenkins-zh
-d 后台运行镜像
-p 10240:8080 意义： 将镜像的8080端口映射到服务器的10240端口。
-p 10241:50000 意义：将镜像的50000端口映射到服务器的10241端口
-v /var/jenkins_mount:/var/jenkins_mount 意义： /var/jenkins_home目录为容器jenkins工作目录，我们将硬盘上的一个目录挂载到这个位置，方便后续更新镜像后继续使用原来的工作目录。这里我们设置的就是上面我们创建的 /var/jenkins_mount目录
-v /etc/localtime:/etc/localtime 意义：让容器使用和服务器同样的时间设置。
-v /root/apache-maven-3.6.3:/usr/local/maven 意义：挂载本地maven，前面是服务器上的，后面是挂载到容器上的目录
　–name myjenkins 意义：给容器起一个别名</p>
</blockquote>
<h1 id="交互式启动后切换到后台"><a class="header" href="#交互式启动后切换到后台">交互式启动后切换到后台</a></h1>
<blockquote>
<p>ctrl + p + q</p>
</blockquote>
<h1 id="docker方式运行-注意-docker-方式无法配置前缀"><a class="header" href="#docker方式运行-注意-docker-方式无法配置前缀">Docker方式运行 注意： docker 方式无法配置前缀</a></h1>
<blockquote>
<p>docker run -d -p 8080:8080 -p 10241:50000 -v /var/jenkins_mount:/var/jenkins_home --name myjenkins jenkins/jenkins</p>
</blockquote>
<h1 id="手动安装"><a class="header" href="#手动安装">手动安装</a></h1>
<h1 id="下载仓库"><a class="header" href="#下载仓库">下载仓库</a></h1>
<blockquote>
<p>wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat/jenkins.repo</p>
</blockquote>
<h1 id="导入密钥"><a class="header" href="#导入密钥">导入密钥</a></h1>
<blockquote>
<p>rpm --import https://pkg.jenkins.io/redhat/jenkins.io.key</p>
</blockquote>
<h1 id="如果安装过程中提示公钥尚未安装-可以使用---nogpgcheck-跳过检查"><a class="header" href="#如果安装过程中提示公钥尚未安装-可以使用---nogpgcheck-跳过检查">如果安装过程中提示公钥尚未安装 可以使用 --nogpgcheck 跳过检查</a></h1>
<blockquote>
<p>yum install jenkins -y --nogpgcheck</p>
</blockquote>
<h1 id="安装依赖"><a class="header" href="#安装依赖">安装依赖</a></h1>
<blockquote>
<p>yum install fontconfig java-11-openjdk</p>
</blockquote>
<h1 id="安装软件"><a class="header" href="#安装软件">安装软件</a></h1>
<blockquote>
<p>yum install jenkins</p>
</blockquote>
<h1 id="修改配置"><a class="header" href="#修改配置">修改配置</a></h1>
<blockquote>
<p>vim /bin/jenkins</p>
</blockquote>
<h1 id="搜索---webroot-方式一"><a class="header" href="#搜索---webroot-方式一">搜索 --webroot 方式一</a></h1>
<blockquote>
<p>#添加前缀 在--webroot 后面添加
--prefix='/jenkins'</p>
</blockquote>
<h1 id="修改配置文件修改后将jdk中的java可执行文件映射到usrbin目录下"><a class="header" href="#修改配置文件修改后将jdk中的java可执行文件映射到usrbin目录下">修改配置文件(修改后将jdk中的java可执行文件映射到/usr/bin/目录下)</a></h1>
<blockquote>
<p>ln -s /usr/jdk-11.0.12/bin/java /usr/bin/
vim /etc/init.d/jenkins</p>
</blockquote>
<h1 id="修改端口"><a class="header" href="#修改端口">修改端口</a></h1>
<blockquote>
<p>vim /etc/sysconfig/jenkins</p>
</blockquote>
<h1 id="修改服务文件-添加前缀方式二"><a class="header" href="#修改服务文件-添加前缀方式二">修改服务文件 添加前缀方式二</a></h1>
<h1 id="在-service下方增加一行用于设置请求前缀-environmentjenkins_prefixjenkins"><a class="header" href="#在-service下方增加一行用于设置请求前缀-environmentjenkins_prefixjenkins">在 [Service]下方增加一行用于设置请求前缀 Environment=&quot;JENKINS_PREFIX=/jenkins&quot;</a></h1>
<blockquote>
<p>vim /usr/lib/systemd/system/jenkins.service</p>
<p>vim /usr/lib/firewalld/services/jenkins.xml</p>
<p>vim /etc/systemd/system/jenkins.service</p>
</blockquote>
<h1 id="使配置文件生效"><a class="header" href="#使配置文件生效">使配置文件生效</a></h1>
<blockquote>
<p>systemctl daemon-reload</p>
</blockquote>
<h1 id="使用临时变量-启动"><a class="header" href="#使用临时变量-启动">使用临时变量 启动</a></h1>
<blockquote>
<p>export JAVA_HOME=/usr/jdk-17.0.3
export PATH=$PATH:$JAVA_HOME/bin
export CLASSPATH=.:$JAVA_HIOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</p>
</blockquote>
<h1 id="启动"><a class="header" href="#启动">启动</a></h1>
<blockquote>
<p>systemctl start jenkins</p>
</blockquote>
<h1 id="初始admin密码"><a class="header" href="#初始admin密码">初始admin密码</a></h1>
<blockquote>
<p>vim /var/lib/jenkins/secrets/initialAdminPassword</p>
</blockquote>
<h1 id="修改插件下载"><a class="header" href="#修改插件下载">修改插件下载</a></h1>
<blockquote>
<p>cd /var/lib/jenkins/updates/</p>
</blockquote>
<h1 id="修改defaultjson中的链接替换为清华源"><a class="header" href="#修改defaultjson中的链接替换为清华源">修改default.json中的链接替换为清华源</a></h1>
<blockquote>
<p>sed -i 's/http://updates.jenkins-ci.org/download/https://mirrors.tuna.tsinghua.edu.cn/jenkins/g' default.json &amp;&amp; sed -i 's/http://www.google.com/https://www.baidu.com/g' default.json</p>
</blockquote>
<h1 id="修改更新地址"><a class="header" href="#修改更新地址">修改更新地址</a></h1>
<blockquote>
<p>https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</p>
</blockquote>
<h1 id="中文插件安装"><a class="header" href="#中文插件安装">中文插件安装</a></h1>
<blockquote>
<p>Localization: Chinese (Simplified)</p>
</blockquote>
<h1 id="权限配置"><a class="header" href="#权限配置">权限配置</a></h1>
<h1 id="安装权限插件"><a class="header" href="#安装权限插件">安装权限插件</a></h1>
<blockquote>
<p>Role-based Authorization Strategy</p>
</blockquote>
<h1 id="点击全局安全配置"><a class="header" href="#点击全局安全配置">点击全局安全配置</a></h1>
<blockquote>
<p>在授权策略中选择(装了权限插件后生效) 然后保存
Role-Based Strategy</p>
</blockquote>
<h1 id="然后配置权限与账号对应的角色"><a class="header" href="#然后配置权限与账号对应的角色">然后配置权限与账号对应的角色</a></h1>
<h1 id="配置-jdk-与-maven"><a class="header" href="#配置-jdk-与-maven">配置 JDK 与 MAVEN</a></h1>
<blockquote>
<p>管理jenkins -&gt; 全局工具配置 -&gt; 点击 添加JDK -&gt; 指定JDK名字 -&gt; 指定JDK路径 
管理jenkins -&gt; 全局工具配置 -&gt; 点击 添加MAVEN -&gt; 指定MAVEN名字 -&gt; 去掉安装新Maven项 -&gt;指定MAVEN路径 -&gt; 应用保存
管理jenkins -&gt; 系统配置 -&gt; 全局属性 -&gt; 勾选Environment variables -&gt; 添加JAVA_HOME -&gt; 添加M2_HOME -&gt; 添加PATH+EXTRA -&gt; 指定值 -&gt; $M2_HOME/bin -&gt; 应用保存</p>
</blockquote>
<h1 id="注意将服务器的maven_home对应的目录设置权限-chmod-777-maven"><a class="header" href="#注意将服务器的maven_home对应的目录设置权限-chmod-777-maven">注意将服务器的MAVEN_HOME对应的目录设置权限 chmod 777 maven/</a></h1>
<h1 id="如果无法删除工作空间文件请检查工作空间文件所属权是否是jenkins如果不是修改所属权限或删除该文件"><a class="header" href="#如果无法删除工作空间文件请检查工作空间文件所属权是否是jenkins如果不是修改所属权限或删除该文件">如果无法删除工作空间文件请检查工作空间文件所属权是否是jenkins如果不是修改所属权限或删除该文件</a></h1>
<h1 id="使用git-需要jenkins安装git并且所在机器也要安装git"><a class="header" href="#使用git-需要jenkins安装git并且所在机器也要安装git">使用GIT 需要jenkins安装GIT并且所在机器也要安装Git</a></h1>
<h1 id="远程发布发布到容器插件安装注意tomcat必须已经启动才能正常发布"><a class="header" href="#远程发布发布到容器插件安装注意tomcat必须已经启动才能正常发布">远程发布发布到容器插件安装(注意Tomcat必须已经启动才能正常发布)</a></h1>
<blockquote>
<p>Deploy to container</p>
</blockquote>
<h1 id="jenkins-配置tomcat发布-将以下配置添加到tomcat-users块下面"><a class="header" href="#jenkins-配置tomcat发布-将以下配置添加到tomcat-users块下面">jenkins 配置Tomcat发布 将以下配置添加到tomcat-users块下面</a></h1>
<blockquote>
<role rolename="tomcat"/>
<role rolename="manager-script"/>
<role rolename="manager-gui"/>
<role rolename="manager-jmx"/>
<role rolename="manager-status"/>
<role rolename="admin-gui"/>
<role rolename="admin-script"/>
<user username="Tang" password="tangtang" roles="tomcat,manager-script,manager-gui,manager-jmx,manager-status,admin-gui,admin-script"/>
</blockquote>
<h1 id="并设置允许远程访问的地址"><a class="header" href="#并设置允许远程访问的地址">并设置允许远程访问的地址</a></h1>
<blockquote>
<p>tomcat/webapps/manager/META-INF/context.xml</p>
</blockquote>
<h1 id="下载安装maven插件"><a class="header" href="#下载安装maven插件">下载安装Maven插件</a></h1>
<blockquote>
<p>Maven Integration</p>
</blockquote>
<h1 id="下载安装pipeline"><a class="header" href="#下载安装pipeline">下载安装pipeline</a></h1>
<blockquote>
<p>Pipeline</p>
</blockquote>
<h1 id="hello-world"><a class="header" href="#hello-world">hello World</a></h1>
<blockquote>
<p>pipeline {
agent any</p>
<pre><code>stages {
    // 步骤 
    stage('pull code') {
        steps {
            echo '拉取代码'
        }
    }
    
    stage('build Project') {
        steps {
            echo '编译代码'
        }
    }
    
    stage('publish Package') {
        steps {
            echo '发包部署'
        }
    }
}
</code></pre>
<p>}</p>
</blockquote>
<h1 id="安装gitlab插件"><a class="header" href="#安装gitlab插件">安装gitLab插件</a></h1>
<blockquote>
<p>使用gitlab管理员账号设置允许发送外部请求
admin Area -&gt; Settings -&gt; Network -&gt; Outbound requests -&gt; Allow requests to the local network from web hooks and services -&gt; save</p>
</blockquote>
<h1 id="使用webhook"><a class="header" href="#使用webhook">使用WEBHOOK</a></h1>
<blockquote>
<p>关闭jenkins中配置 
管理jenkins -&gt; 系统配置 -&gt; Gitlab - &gt; 取消勾选 Enable authentication for '/project' end-point -&gt; 删除下方GitLab connections块 -&gt; 应用保存</p>
</blockquote>
<h1 id="安装publish-over-ssh插件远程部署"><a class="header" href="#安装publish-over-ssh插件远程部署">安装Publish Over SSH插件（远程部署）</a></h1>
<blockquote>
<p>Publish Over SSH
管理jenkins -&gt; 系统配置 -&gt;  Publish over SSH -&gt; path to key 填写私钥路径 -&gt; key 填写私钥内容</p>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="JDBC.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="Lock.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="JDBC.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="Lock.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
